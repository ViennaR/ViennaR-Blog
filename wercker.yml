box: debian
build:
  steps:
    - arjen/hugo-build:
      version: 0.14
      flags: --buildDrafts=true
deploy:
  steps:
    # Execute the s3sync deploy step, a step provided by wercker
    - s3sync:
      key_id: $AWS_ACCESS_KEY_ID
      key_secret: $AWS_SECRET_ACCESS_KEY
      bucket_url: $AWS_BUCKET_URL
      source_dir: public/
    # Deploy to world4you server
    - script:
        name: update apt source mirror
        code: sed -i 's/httpredir.debian.org/cloudfront.debian.net/g' /etc/apt/sources.list
    - install-packages:
        packages: lftp
    - script:
        name: sync with remote
        code: lftp -e "open -u $FTPUSER,$FTPPASSWORD ftp84.world4you.com; mirror -c -R public /;quit"
